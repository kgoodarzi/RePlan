{"id": "REPLAN-037", "title": "Add ability to ungroup objects in object viewer", "description": "Users need to be able to ungroup objects, especially mark_text objects that were grouped during OCR detection, into individual components. This is essential for removing false positives from grouped text regions. Implementation should allow selecting a grouped object and splitting it into individual elements, creating separate objects for each element while preserving their masks and properties.", "priority": "high", "status": "open", "labels": ["feature", "ui", "editing", "ocr"], "created": "2026-01-27", "order": 14, "depends_on": ["REPLAN-034"]}
{"id": "REPLAN-021", "title": "Add scale, rotate, and mirror transformations for segments", "description": "IN PROGRESS: Currently only translation (move) is supported. Need to add scale, rotate (per-segment, not just page-level), and mirror transformations. Foundation exists in _finish_move_objects() which transforms masks and pixels using cv2.warpAffine. Next steps: Create _transform_elements() helper function for scale/rotate/mirror, add UI controls in context menu and toolbar, implement transformation dialogs for user input (scale factor, rotation angle, mirror axis).", "priority": "medium", "status": "in_progress", "labels": ["feature", "editing", "transformations"], "created": "2026-01-27", "order": 19}
{"id": "REPLAN-023", "title": "Implement true polygon nesting instead of bounding box", "description": "Current nesting uses bounding boxes only, wasting material on non-rectangular parts. Implement polygon-level nesting for better material utilization, especially for wing ribs and curved parts.", "priority": "medium", "status": "open", "labels": ["feature", "nesting", "optimization"], "created": "2026-01-27", "order": 21, "depends_on": ["REPLAN-016"]}
{"id": "REPLAN-024", "title": "Add tile printing for large plans", "description": "Split large plans across multiple sheets with alignment marks for reassembly. Essential for printing full-size plans on standard printers.", "priority": "medium", "status": "open", "labels": ["feature", "printing"], "created": "2026-01-27", "order": 22, "depends_on": ["REPLAN-020"]}
{"id": "REPLAN-009", "title": "Optimize canvas rendering for smooth zoom/pan", "description": "Profile and optimize canvas rendering to achieve < 100ms updates", "priority": "medium", "status": "open", "labels": ["performance", "ui"], "created": "2026-01-27", "order": 23, "depends_on": ["REPLAN-001"]}
{"id": "REPLAN-010", "title": "Optimize workspace save/load", "description": "Profile and optimize workspace serialization to < 1 second", "priority": "medium", "status": "open", "labels": ["performance", "io"], "created": "2026-01-27", "order": 24, "depends_on": ["REPLAN-001"]}
{"id": "REPLAN-011", "title": "Add keyboard shortcuts", "description": "Implement comprehensive keyboard navigation and shortcuts", "priority": "medium", "status": "open", "labels": ["feature", "ui"], "created": "2026-01-27", "order": 25}
{"id": "REPLAN-012", "title": "Add right-click context menus", "description": "Implement context menus for quick actions on objects", "priority": "medium", "status": "open", "labels": ["feature", "ui"], "created": "2026-01-27", "order": 26}
{"id": "REPLAN-035", "title": "Review and address performance warnings in console logs", "description": "Documented all performance warnings in docs/PERFORMANCE_WARNINGS.md. Review console logs for: PerformanceProfiler warnings (operations exceeding targets), mask update times > 1s, memory warnings during workspace load, canvas_render times > 100ms. Address identified bottlenecks.", "priority": "medium", "status": "open", "labels": ["performance", "documentation"], "created": "2026-01-27", "order": 28, "depends_on": ["REPLAN-001"]}
{"id": "REPLAN-025", "title": "Create parts library system", "description": "Save and reuse common part shapes as templates. Include standard model aircraft components (ribs, formers, control horns, hinges) that can be inserted and scaled.", "priority": "low", "status": "open", "labels": ["feature", "library"], "created": "2026-01-27", "order": 29}
{"id": "REPLAN-026", "title": "Add parametric part generation", "description": "Generate formers, ribs, and other parts from parameters (chord, thickness, lightening holes, tab positions). Enable modification of parts by adjusting parameters rather than redrawing.", "priority": "low", "status": "open", "labels": ["feature", "parametric"], "created": "2026-01-27", "order": 30}
{"id": "REPLAN-027", "title": "Add print preview dialog", "description": "Create print dialog with preview, page setup, scale options, and tile configuration. Currently only PNG export exists with no print-to-printer functionality.", "priority": "low", "status": "open", "labels": ["feature", "printing", "ui"], "created": "2026-01-27", "order": 31, "depends_on": ["REPLAN-020"]}
{"id": "REPLAN-028", "title": "Add legend panel to exports", "description": "Include color key/legend showing category colors and labels in exported images and prints. Currently labels are shown but no separate legend panel.", "priority": "low", "status": "open", "labels": ["feature", "export", "ui"], "created": "2026-01-27", "order": 32}
{"id": "REPLAN-013", "title": "Add WebSocket collaboration support", "description": "Enable real-time multi-user editing via WebSocket", "priority": "low", "status": "open", "labels": ["feature", "collaboration"], "created": "2026-01-27", "order": 33}
{"id": "REPLAN-014", "title": "Add 3D visualization preview", "description": "Generate 3D model preview from 2D annotated plans", "priority": "low", "status": "open", "labels": ["feature", "visualization"], "created": "2026-01-27", "order": 34}
{"id": "REPLAN-015", "title": "Add CAM integration for laser cutting", "description": "Export directly to laser cutter formats (G-code, etc.)", "priority": "low", "status": "open", "labels": ["feature", "manufacturing"], "created": "2026-01-27", "order": 35, "depends_on": ["REPLAN-016"]}
{"id": "REPLAN-001", "title": "Add performance profiling instrumentation", "description": "Add timing decorators to all major operations to measure current performance baseline. DONE: Added @timed() decorators to flood_fill, polygon_mask, canvas_render, nesting_compute, pdf_load, workspace_save, workspace_load.", "priority": "high", "status": "closed", "labels": ["performance", "infrastructure"], "created": "2026-01-27", "order": 1}
{"id": "REPLAN-006", "title": "Add unit tests for models module", "description": "Create comprehensive unit tests for all data models in replan.desktop.models. Target 90% branch coverage. DONE: 224 tests (up from 175) covering attributes (29 tests including edge cases for negative/zero dimensions, invalid types, size_string variations), categories (comprehensive coverage), elements (comprehensive coverage including all 9 label positions, RLE encoding/decoding verification, edge cases for bounds/centroid/area with single pixels, holes, scattered pixels), objects (comprehensive coverage including edge cases for grouped elements, multiple instances, attribute migration), and page models (comprehensive coverage including edge cases for multiple objects, element counting, pixels_per_inch calculations).", "priority": "high", "status": "closed", "labels": ["testing"], "created": "2026-01-27", "order": 2}
{"id": "REPLAN-007", "title": "Add unit tests for core module", "description": "Create unit tests for segmentation, rendering, and drawing logic. Target 90% branch coverage. COMPLETED: Achieved 93.03% coverage (exceeds 90% target). Added comprehensive tests - segmentation.py: 95% coverage, drawing.py: 96% coverage (added tests for snap branches, empty mask, invalid points, finish methods), rendering.py: 89% coverage (added tests for text mask growth, label drawing branches, pixel selection, empty contours), nesting.py: 78% coverage (added tests for nest_by_material, empty stock parts, boundary clipping, render branches). Models module: 224 tests (100% coverage). Total: 434 tests passing. Coverage target achieved!", "priority": "high", "status": "closed", "labels": ["testing"], "created": "2026-01-27", "order": 3, "depends_on": ["REPLAN-006"]}
{"id": "REPLAN-016", "title": "Implement DXF vector export", "description": "Add DXF export using contour extraction from SegmentationEngine.get_contours(). Extract polygon paths from raster masks and export as DXF polylines for CAD/laser cutting workflows. DONE: Created vector_export.py with ContourExtractor, DXFExporter classes.", "priority": "high", "status": "closed", "labels": ["feature", "export", "vectorization"], "created": "2026-01-27", "order": 4}
{"id": "REPLAN-017", "title": "Implement SVG vector export", "description": "Add SVG export using contour extraction. Export segment boundaries as SVG paths for scalable vector editing and web display. DONE: Created SVGExporter with category grouping, colors, and path data generation.", "priority": "high", "status": "closed", "labels": ["feature", "export", "vectorization"], "created": "2026-01-27", "order": 5, "depends_on": ["REPLAN-016"]}
{"id": "REPLAN-018", "title": "Implement 1D linear material nesting for sticks/strips", "description": "Add 1D bin packing algorithm for linear materials (balsa strips, spruce sticks, longerons, spars). DONE: Added LinearNestingEngine with FFD algorithm, LinearPart, NestedStock, NestedLinearPart dataclasses.", "priority": "high", "status": "closed", "labels": ["feature", "nesting", "materials"], "created": "2026-01-27", "order": 6}
{"id": "REPLAN-019", "title": "Add structured cut list/inventory export from nesting", "description": "Generate shopping list from nesting results: how many sheets of each size/material, how many sticks of each dimension. DONE: Added InventoryExporter with export_inventory(), export_shopping_list(), export_cut_list_text() methods.", "priority": "high", "status": "closed", "labels": ["feature", "export", "nesting"], "created": "2026-01-27", "order": 7, "depends_on": ["REPLAN-018"]}
{"id": "REPLAN-020", "title": "Implement 1:1 scale printing with DPI handling", "description": "Add print functionality that uses stored DPI and physical dimensions (pdf_width_inches, pdf_height_inches in PageTab) to output parts at actual size. DONE: Created printing.py with ScaledPrinter, PrintSettings, tile export, alignment marks, and scale bar.", "priority": "high", "status": "closed", "labels": ["feature", "printing"], "created": "2026-01-27", "order": 8}
{"id": "REPLAN-008", "title": "Add integration tests", "description": "Create end-to-end workflow tests: load PDF -> segment -> save workspace. Target 90% branch coverage. COMPLETED: Created comprehensive integration tests in tests/integration/test_workflow.py covering: PDF loading workflow, segmentation workflow (flood fill, polygon, line masks), workspace save/load workflow, complete end-to-end workflow (create page -> segment -> save -> load), multi-page workflows. Added performance tests in test_performance.py to verify PDF load (< 2s) and flood fill (< 1s) targets. Total: 12 integration tests passing.", "priority": "high", "status": "closed", "labels": ["testing"], "created": "2026-01-27", "order": 9, "depends_on": ["REPLAN-006", "REPLAN-007"]}
{"id": "REPLAN-002", "title": "Optimize PDF loading to < 2 seconds", "description": "Profile and optimize PDF loading, page rendering, and initial display. COMPLETED: Optimizations implemented - use alpha=False to get RGB directly (avoids RGBA->BGR conversion), direct memory access via np.frombuffer, single RGB->BGR conversion, automatic resizing for large images. Performance profiling in place via @timed('pdf_load') decorator with 2000ms target. Code verified in pdf_reader.py:load_with_dimensions(). Integration tests added to verify performance targets.", "priority": "high", "status": "closed", "labels": ["performance", "pdf"], "created": "2026-01-27", "order": 10, "depends_on": ["REPLAN-001"]}
{"id": "REPLAN-003", "title": "Optimize flood fill to < 1 second", "description": "Profile and optimize flood fill operations for typical image sizes. COMPLETED: Optimizations implemented - check if image is already grayscale before conversion (avoids unnecessary cv2.cvtColor), efficient mask extraction using direct indexing (result[1:-1, 1:-1]), binary conversion using multiplication (faster than np.where), use FLOODFILL_MASK_ONLY flag. Performance profiling in place via @timed('flood_fill') decorator with 1000ms target. Code verified in segmentation.py:flood_fill(). Integration tests added to verify performance targets.", "priority": "high", "status": "closed", "labels": ["performance", "segmentation"], "created": "2026-01-27", "order": 11, "depends_on": ["REPLAN-001"]}
{"id": "REPLAN-004", "title": "Implement auto text region detection", "description": "COMPLETED: Added CV-based automatic detection of text regions in drawings. Implemented _detect_text_regions() using pytesseract OCR with word-level detection, _auto_detect_text_for_page() for background detection, integrated automatic detection in _add_page() when pages are loaded (not from workspace), added UI controls in settings dialog (Preferences > Behavior). Users can enable/disable automatic text detection. Detection runs in background (100ms delay) to avoid blocking UI. Detected regions are added to mark_text category as objects.", "priority": "high", "status": "closed", "labels": ["feature", "auto-detection"], "created": "2026-01-27", "order": 12}
{"id": "REPLAN-005", "title": "Implement auto hatch region detection", "description": "COMPLETED: Added CV-based automatic detection of hatching/cross-hatch pattern regions. Implemented _detect_hatching_regions() using Canny edge detection and Hough transform to find diagonal line patterns typical of hatching (~45° or ~135°), _auto_detect_hatch_for_page() for background detection, integrated automatic detection in _add_page() when pages are loaded (not from workspace), added UI controls in settings dialog (Preferences > Behavior). Users can enable/disable automatic hatch detection. Detection runs in background (200ms delay) to avoid blocking UI. Uses morphological operations to group nearby lines into regions.", "priority": "high", "status": "closed", "labels": ["feature", "auto-detection"], "created": "2026-01-27", "order": 13}
{"id": "REPLAN-038", "title": "Optimize OCR to reduce false positive text detections", "description": "COMPLETED: Optimized OCR text detection to significantly reduce false positives. Implemented multiple filtering criteria: increased confidence threshold (30→50), changed PSM mode (3→6 for uniform text blocks), stricter size limits (5% max area, 8x8 min), aspect ratio filtering (reject very wide/tall boxes), text content validation (require alphanumeric content, filter single symbols), and pixel density checks (10-70% dark pixels). These filters ensure only actual text regions are detected, reducing the number of text_xxx false positive objects.", "priority": "high", "status": "closed", "labels": ["bug", "ocr", "optimization"], "created": "2026-01-27", "order": 15}
{"id": "REPLAN-039", "title": "Fix text grouping algorithm to properly group multi-line textboxes", "description": "COMPLETED: Fixed text grouping algorithm that was incorrectly splitting multi-line textboxes. The old algorithm was creating vertical sections mixing words from different lines. New two-stage approach: Stage 1 groups regions into lines (horizontally aligned), Stage 2 groups lines into textboxes (vertically aligned with similar left/right edges). This ensures a 3-line textbox is grouped as a single textbox rather than being split into separate vertical sections.", "priority": "high", "status": "closed", "labels": ["bug", "ocr", "text-grouping"], "created": "2026-01-27", "order": 16}
{"id": "REPLAN-029", "title": "Remember object viewer panel size on workspace load", "description": "When workspace opens, it is not remembering the size of the right hand side object viewer panel. Save panel size/width in workspace settings and restore on load. DONE: Added object_panel_width to view_state in _get_view_state(), restored in _restore_view_state() with deferred execution after layout initialization. Panel width is saved to workspace file and restored on load.", "priority": "medium", "status": "closed", "labels": ["bug", "ui", "workspace"], "created": "2026-01-27", "order": 14}
{"id": "REPLAN-030", "title": "Auto-fit image to screen on first load", "description": "When an image is loaded (whether new PDF opened or new page created), the image should be shown in fit-to-screen mode for the first time. Currently users must manually zoom to fit. DONE: Added _auto_fit_page_on_first_load() method that ensures canvas is ready before fitting. Auto-fit now triggers when pages are first added (not from workspace) and when switching to a page for the first time. Uses _has_been_fitted flag to track which pages have been auto-fitted.", "priority": "medium", "status": "closed", "labels": ["bug", "ui", "viewing"], "created": "2026-01-27", "order": 15}
{"id": "REPLAN-031", "title": "Remember window position and size on app start", "description": "When the app starts, it doesn't reopen in the last known state for window position and location. Save window geometry (x, y, width, height, maximized) on close and restore on startup. DONE: Enhanced window geometry saving/restoration. Window position (x, y), size (width, height), and maximized state are now properly saved on close and restored on startup. Added error handling and fallback logic. Settings are persisted to disk on close.", "priority": "medium", "status": "closed", "labels": ["bug", "ui", "window"], "created": "2026-01-27", "order": 16}
{"id": "REPLAN-032", "title": "Deleted OCR items remain hidden when mark_text category unchecked", "description": "COMPLETED: Fixed bug where deleted OCR items remained hidden when mark_text category was unchecked. Issue was that working image cache wasn't invalidated when mark_text objects were deleted while mark_text visibility was off. Solution: Added cache invalidation in _delete_selected() before updating combined masks when mark_text/hatch/line objects are deleted and their respective category visibility is off. This ensures deleted objects' pixels are properly restored when category is unchecked. Also handles mark_hatch and mark_line categories for consistency.", "priority": "medium", "status": "closed", "labels": ["bug", "ui", "ocr"], "created": "2026-01-27", "order": 17}
{"id": "REPLAN-034", "title": "Group OCR text in notes/textboxes as single objects", "description": "COMPLETED: Implemented improved clustering algorithm to group nearby text regions into logical textboxes/notes. Enhanced group_text_regions() with stricter overlap requirements (50% instead of 30%) and edge alignment detection to avoid over-grouping. Added max_group_size parameter (10) to prevent excessive grouping. Enabled grouping in both _run_ocr_for_page() and _auto_detect_text_for_page() with conservative parameters (max_horizontal_gap=0.25, max_vertical_gap=0.4, min_group_size=2). Grouped regions are stored with combined masks, text, and bounding boxes, and added as single objects to mark_text category.", "priority": "medium", "status": "closed", "labels": ["feature", "ocr", "text-detection"], "created": "2026-01-27", "order": 18, "depends_on": ["REPLAN-004"]}
{"id": "REPLAN-022", "title": "Add part type replacement/conversion workflow", "description": "COMPLETED: Part type replacement/conversion is now available via REPLAN-036 (Change Category feature). Users can convert between part types (e.g., curved wingtip to cutout template, solid former to lightened former) by selecting objects and using \"Change Category\" from the context menu. The implementation preserves mask and geometry while updating category and associated rendering. Category change dialog shows all available categories with current category excluded. This provides the foundation for part type conversion workflows.", "priority": "medium", "status": "closed", "labels": ["feature", "editing"], "created": "2026-01-27", "order": 20}
{"id": "REPLAN-036", "title": "Add ability to move objects between categories", "description": "COMPLETED: Implemented ability to move objects between categories. Created CategorySelectionDialog for selecting target category. Added _change_object_category() method that updates object.category and all element.category fields, updates element colors to match new category, handles mark_text/mark_hatch/mark_line mask updates, invalidates cache appropriately, and updates tree view. Added \"Change Category\" menu item to object viewer context menu. Users can now reclassify objects (e.g., move misclassified ribs, change formers to planforms) without deleting and recreating.", "priority": "medium", "status": "closed", "labels": ["feature", "editing", "ui"], "created": "2026-01-27", "order": 20}
{"id": "REPLAN-033", "title": "Add search functionality to object viewer", "description": "COMPLETED: Added search box at top of object tree with real-time filtering. Search filters objects by name, category name/full name, material, view, size_string, view_type, and page_id. Includes placeholder text, debounced updates (150ms), auto-expansion of categories when searching, hiding of empty categories/views, and keyboard shortcuts (Escape to clear, Ctrl+F to focus). Search works with all grouping modes (none, category, view).", "priority": "medium", "status": "closed", "labels": ["feature", "ui", "search"], "created": "2026-01-27", "order": 27}

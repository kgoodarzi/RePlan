{"id": "REPLAN-056", "status": "open", "title": "Make Tools and Objects panels dockable", "created": "2026-01-29", "description": "The Tools and Objects panels should be dockable, allowing users to rearrange them, dock them to different sides of the window, or undock them as floating windows. Currently panels are fixed in position. Implementation needed: 1) Add docking framework (similar to VS Code), 2) Allow panels to be dragged and docked to different sides (left, right, top, bottom), 3) Support undocking panels as floating windows, 4) Save docked positions in workspace/settings, 5) Add visual feedback during drag operations, 6) Handle panel resizing when docked.", "labels": ["feature", "ui", "docking"], "order": 56, "priority": "medium"}
{"id": "REPLAN-060", "status": "closed", "title": "Clean up View menu - remove leftover separators from removed menu items", "created": "2026-01-30", "description": "Menu items removed from View menu (Hide Background, Hide Hatching, Run OCR, Create View Tab) have left behind separator lines. These separators need to be cleaned up to maintain a clean menu structure. DONE: Removed duplicate separators and added proper 'Manage Mask Regions' menu item.", "labels": ["bug", "ui", "menu"], "order": 60, "priority": "low"}
{"id": "REPLAN-061", "status": "closed", "title": "Print preview should use standard Windows print dialog and spooler", "created": "2026-01-30", "description": "Print preview dialog should use the standard Windows print dialog (via win32print or similar) and printer spooler for settings. This includes paper size, orientation, tile printing options, margins, and other print settings. The current implementation uses a custom dialog - should integrate with system print dialog for better user experience and consistency. DONE: Enhanced print functionality to use Windows print spooler via win32print/win32ui, with fallback to system print dialog via temp file.", "labels": ["feature", "printing", "ui"], "order": 61, "priority": "medium"}
{"id": "REPLAN-062", "status": "closed", "title": "Preserve collapse/expand status of Tools panel sections in workspace", "created": "2026-01-30", "description": "The collapse/expand status of collapsible sections in the Tools panel (Selection Mode, Categories, Label Position, etc.) should be saved in the workspace and restored when the workspace is loaded. Currently, all sections default to expanded state on load. DONE: Added tools_sections_state to view_state, saving collapse/expand state of all collapsible sections and restoring on workspace load.", "labels": ["feature", "ui", "workspace"], "order": 62, "priority": "medium"}
{"id": "REPLAN-063", "status": "closed", "title": "Fix Tools panel scrolling boundaries - still allows scrolling beyond content", "created": "2026-01-30", "description": "The Tools panel scrolling fix (REPLAN-048) did not fully resolve the issue. Users can still scroll above the Selection Mode section and below the Quick Actions section. The scroll region bounds need to be more strictly enforced to prevent scrolling beyond the meaningful content boundaries. DONE: Enhanced scroll region enforcement with stricter bounds checking, constrained mousewheel handler, and proper clamping of scroll positions.", "labels": ["bug", "ui"], "order": 63, "priority": "medium"}
{"id": "REPLAN-064", "status": "closed", "title": "Enhance paint mode with color picker and pen width control", "created": "2026-01-30", "description": "Paint mode currently has basic color selection (Black, White, Red, Green, Blue) and brush size (1-50px). Should be enhanced with: 1) Full color picker dialog for custom colors, 2) More granular pen width control (maybe 1-100px or slider), 3) Visual brush size indicator on canvas, 4) Pressure sensitivity support if available, 5) Brush opacity/alpha support. DONE: Added Paint Settings collapsible section with brush size control (1-100px), color preset buttons, and full color picker dialog. Settings section shows/hides based on paint mode selection.", "labels": ["feature", "editing", "tools"], "order": 64, "priority": "medium"}
{"id": "REPLAN-029", "status": "closed", "title": "Remember object viewer panel size on workspace load", "created": "2026-01-27", "description": "When workspace opens, it is not remembering the size of the right hand side object viewer panel. Save panel size/width in workspace settings and restore on load. DONE: Added object_panel_width to view_state in _get_view_state(), restored in _restore_view_state() with deferred execution after layout initialization. Panel width is saved to workspace file and restored on load.", "labels": ["bug", "ui", "workspace"], "order": 14, "priority": "medium"}
{"id": "REPLAN-030", "status": "closed", "title": "Auto-fit image to screen on first load", "created": "2026-01-27", "description": "When an image is loaded (whether new PDF opened or new page created), the image should be shown in fit-to-screen mode for the first time. Currently users must manually zoom to fit. DONE: Added _auto_fit_page_on_first_load() method that ensures canvas is ready before fitting. Auto-fit now triggers when pages are first added (not from workspace) and when switching to a page for the first time. Uses _has_been_fitted flag to track which pages have been auto-fitted.", "labels": ["bug", "ui", "viewing"], "order": 15, "priority": "medium"}
{"id": "REPLAN-031", "status": "closed", "title": "Remember window position and size on app start", "created": "2026-01-27", "description": "When the app starts, it doesn't reopen in the last known state for window position and location. Save window geometry (x, y, width, height, maximized) on close and restore on startup. DONE: Enhanced window geometry saving/restoration. Window position (x, y), size (width, height), and maximized state are now properly saved on close and restored on startup. Added error handling and fallback logic. Settings are persisted to disk on close.", "labels": ["bug", "ui", "window"], "order": 16, "priority": "medium"}
{"id": "REPLAN-032", "status": "closed", "title": "Deleted OCR items remain hidden when mark_text category unchecked", "created": "2026-01-27", "description": "COMPLETED: Fixed bug where deleted OCR items remained hidden when mark_text category was unchecked. Issue was that working image cache wasn't invalidated when mark_text objects were deleted while mark_text visibility was off. Solution: Added cache invalidation in _delete_selected() before updating combined masks when mark_text/hatch/line objects are deleted and their respective category visibility is off. This ensures deleted objects' pixels are properly restored when category is unchecked. Also handles mark_hatch and mark_line categories for consistency.", "labels": ["bug", "ui", "ocr"], "order": 17, "priority": "medium"}
{"id": "REPLAN-034", "status": "closed", "title": "Group OCR text in notes/textboxes as single objects", "created": "2026-01-27", "depends_on": ["REPLAN-004"], "description": "COMPLETED: Implemented improved clustering algorithm to group nearby text regions into logical textboxes/notes. Enhanced group_text_regions() with stricter overlap requirements (50% instead of 30%) and edge alignment detection to avoid over-grouping. Added max_group_size parameter (10) to prevent excessive grouping. Enabled grouping in both _run_ocr_for_page() and _auto_detect_text_for_page() with conservative parameters (max_horizontal_gap=0.25, max_vertical_gap=0.4, min_group_size=2). Grouped regions are stored with combined masks, text, and bounding boxes, and added as single objects to mark_text category.", "labels": ["feature", "ocr", "text-detection"], "order": 18, "priority": "medium"}
{"id": "REPLAN-021", "status": "closed", "title": "Add scale, rotate, and mirror transformations for segments", "created": "2026-01-27", "description": "IN PROGRESS: Currently only translation (move) is supported. Need to add scale, rotate (per-segment, not just page-level), and mirror transformations. Foundation exists in _finish_move_objects() which transforms masks and pixels using cv2.warpAffine. Next steps: Create _transform_elements() helper function for scale/rotate/mirror, add UI controls in context menu and toolbar, implement transformation dialogs for user input (scale factor, rotation angle, mirror axis).", "labels": ["feature", "editing", "transformations"], "order": 19, "priority": "medium"}
{"id": "REPLAN-022", "status": "closed", "title": "Add part type replacement/conversion workflow", "created": "2026-01-27", "description": "COMPLETED: Part type replacement/conversion is now available via REPLAN-036 (Change Category feature). Users can convert between part types (e.g., curved wingtip to cutout template, solid former to lightened former) by selecting objects and using \"Change Category\" from the context menu. The implementation preserves mask and geometry while updating category and associated rendering. Category change dialog shows all available categories with current category excluded. This provides the foundation for part type conversion workflows.", "labels": ["feature", "editing"], "order": 20, "priority": "medium"}
{"id": "REPLAN-036", "status": "closed", "title": "Add ability to move objects between categories", "created": "2026-01-27", "description": "COMPLETED: Implemented ability to move objects between categories. Created CategorySelectionDialog for selecting target category. Added _change_object_category() method that updates object.category and all element.category fields, updates element colors to match new category, handles mark_text/mark_hatch/mark_line mask updates, invalidates cache appropriately, and updates tree view. Added \"Change Category\" menu item to object viewer context menu. Users can now reclassify objects (e.g., move misclassified ribs, change formers to planforms) without deleting and recreating.", "labels": ["feature", "editing", "ui"], "order": 20, "priority": "medium"}
{"id": "REPLAN-023", "status": "closed", "title": "Implement true polygon nesting instead of bounding box", "created": "2026-01-27", "depends_on": ["REPLAN-016"], "description": "Current nesting uses bounding boxes only, wasting material on non-rectangular parts. Implement polygon-level nesting for better material utilization, especially for wing ribs and curved parts.", "labels": ["feature", "nesting", "optimization"], "order": 21, "priority": "medium"}
{"id": "REPLAN-024", "status": "closed", "title": "Add tile printing for large plans", "created": "2026-01-27", "depends_on": ["REPLAN-020"], "description": "Split large plans across multiple sheets with alignment marks for reassembly. Essential for printing full-size plans on standard printers.", "labels": ["feature", "printing"], "order": 22, "priority": "medium"}
{"id": "REPLAN-009", "status": "closed", "title": "Optimize canvas rendering for smooth zoom/pan", "created": "2026-01-27", "depends_on": ["REPLAN-001"], "description": "Profile and optimize canvas rendering to achieve < 100ms updates", "labels": ["performance", "ui"], "order": 23, "priority": "medium"}
{"id": "REPLAN-010", "status": "closed", "title": "Optimize workspace save/load", "created": "2026-01-27", "depends_on": ["REPLAN-001"], "description": "Profile and optimize workspace serialization to < 1 second", "labels": ["performance", "io"], "order": 24, "priority": "medium"}
{"id": "REPLAN-011", "status": "closed", "title": "Add keyboard shortcuts", "created": "2026-01-27", "description": "Implement comprehensive keyboard navigation and shortcuts", "labels": ["feature", "ui"], "order": 25, "priority": "medium"}
{"id": "REPLAN-012", "status": "closed", "title": "Add right-click context menus", "created": "2026-01-27", "description": "Implement context menus for quick actions on objects", "labels": ["feature", "ui"], "order": 26, "priority": "medium"}
{"id": "REPLAN-033", "status": "closed", "title": "Add search functionality to object viewer", "created": "2026-01-27", "description": "COMPLETED: Added search box at top of object tree with real-time filtering. Search filters objects by name, category name/full name, material, view, size_string, view_type, and page_id. Includes placeholder text, debounced updates (150ms), auto-expansion of categories when searching, hiding of empty categories/views, and keyboard shortcuts (Escape to clear, Ctrl+F to focus). Search works with all grouping modes (none, category, view).", "labels": ["feature", "ui", "search"], "order": 27, "priority": "medium"}
{"id": "REPLAN-035", "status": "closed", "title": "Review and address performance warnings in console logs", "created": "2026-01-27", "depends_on": ["REPLAN-001"], "description": "Documented all performance warnings in docs/PERFORMANCE_WARNINGS.md. Review console logs for: PerformanceProfiler warnings (operations exceeding targets), mask update times > 1s, memory warnings during workspace load, canvas_render times > 100ms. Address identified bottlenecks.", "labels": ["performance", "documentation"], "order": 28, "priority": "medium"}
{"id": "REPLAN-025", "status": "closed", "title": "Create parts library system", "created": "2026-01-27", "description": "Save and reuse common part shapes as templates. Include standard model aircraft components (ribs, formers, control horns, hinges) that can be inserted and scaled.", "labels": ["feature", "library"], "order": 29, "priority": "low"}
{"id": "REPLAN-026", "status": "closed", "title": "Add parametric part generation", "created": "2026-01-27", "description": "Generate formers, ribs, and other parts from parameters (chord, thickness, lightening holes, tab positions). Enable modification of parts by adjusting parameters rather than redrawing.", "labels": ["feature", "parametric"], "order": 30, "priority": "low"}
{"id": "REPLAN-027", "status": "closed", "title": "Add print preview dialog", "created": "2026-01-27", "depends_on": ["REPLAN-020"], "description": "Create print dialog with preview, page setup, scale options, and tile configuration. Currently only PNG export exists with no print-to-printer functionality.", "labels": ["feature", "printing", "ui"], "order": 31, "priority": "low"}
{"id": "REPLAN-028", "status": "closed", "title": "Add legend panel to exports", "created": "2026-01-27", "description": "Include color key/legend showing category colors and labels in exported images and prints. Currently labels are shown but no separate legend panel.", "labels": ["feature", "export", "ui"], "order": 32, "priority": "low"}
{"id": "REPLAN-013", "status": "closed", "title": "Add WebSocket collaboration support", "created": "2026-01-27", "description": "Enable real-time multi-user editing via WebSocket", "labels": ["feature", "collaboration"], "order": 33, "priority": "low"}
{"id": "REPLAN-014", "status": "closed", "title": "Add 3D visualization preview", "created": "2026-01-27", "description": "Generate 3D model preview from 2D annotated plans", "labels": ["feature", "visualization"], "order": 34, "priority": "low"}
{"id": "REPLAN-015", "status": "closed", "title": "Add CAM integration for laser cutting", "created": "2026-01-27", "depends_on": ["REPLAN-016"], "description": "Export directly to laser cutter formats (G-code, etc.)", "labels": ["feature", "manufacturing"], "order": 35, "priority": "low"}
{"id": "REPLAN-048", "status": "closed", "title": "Fix Tools panel scrolling - allow scrolling above Selection Mode and below Quick Actions", "created": "2026-01-29", "description": "The Tools panel can be scrolled above the Selection Mode section and below the Quick Actions section, which should not be possible. The scrollable area should be constrained to only the content between these sections. Fix the scroll region bounds in _setup_tools_panel() to prevent scrolling beyond the intended content area.", "labels": ["bug", "ui"], "order": 48, "priority": "medium"}
{"id": "REPLAN-053", "status": "closed", "title": "Reorganize View menu - move Create View tab and Run OCR to Tools menu", "created": "2026-01-29", "description": "The View menu contains actions that should be in the Tools menu. Move \"Create View tab from Planform\" and \"Run OCR\" from View menu to Tools menu. Also remove \"Hide/Unhide Background\" and \"Hide/Unhide Hatching\" from View menu as these should be handled through category visibility toggles instead.", "labels": ["ui", "menu"], "order": 53, "priority": "low"}
{"id": "REPLAN-054", "status": "closed", "title": "Implement smart ruler drawing based on zoom level", "created": "2026-01-29", "description": "The ruler should be intelligently drawn to avoid being too crowded at high zoom-out levels or too sparse at high zoom-in levels. Currently rulers may show too many or too few tick marks depending on zoom. Implementation needed: 1) Calculate appropriate tick mark spacing based on zoom level and screen pixels, 2) Show fewer tick marks at low zoom (zoom out), more at high zoom (zoom in), 3) Adjust label frequency (every N ticks) based on available space, 4) Ensure ruler remains readable at all zoom levels, 5) Consider DPI when calculating tick spacing.", "labels": ["feature", "ui", "ruler"], "order": 54, "priority": "medium"}
{"id": "REPLAN-057", "status": "closed", "title": "Add Shift key constraint for horizontal/vertical object movement", "created": "2026-01-29", "description": "When moving objects, holding the Shift key should constrain movement to either horizontal or vertical direction (whichever direction the user starts moving in). This is a common UX pattern that makes precise alignment easier. Implementation needed: 1) Detect Shift key press during object drag operations, 2) Determine initial movement direction (horizontal vs vertical), 3) Constrain subsequent movement to that axis, 4) Provide visual feedback (e.g., highlight the constrained axis), 5) Apply constraint in _on_drag() and _finish_move_objects().", "labels": ["feature", "editing", "ui"], "order": 57, "priority": "medium"}
{"id": "REPLAN-059", "status": "closed", "title": "Add basic bitmap paint functionality to tools section", "created": "2026-01-30", "description": "Add a paint brush tool that allows users to draw directly on the canvas bitmap. Implementation needed: 1) Add paint mode to selection modes, 2) Implement brush drawing with configurable brush size (1-50 pixels), 3) Support multiple colors (Black, White, Red, Green, Blue), 4) Draw lines between mouse positions during drag, 5) Update original_image directly when painting, 6) Add paint settings UI in tools panel (brush size, color picker), 7) Add keyboard shortcut (t key) for paint mode, 8) Ensure paint strokes are saved in workspace.", "labels": ["feature", "editing", "tools"], "order": 59, "priority": "medium"}
{"id": "REPLAN-001", "status": "closed", "title": "Add performance profiling instrumentation", "created": "2026-01-27", "description": "Add timing decorators to all major operations to measure current performance baseline. DONE: Added @timed() decorators to flood_fill, polygon_mask, canvas_render, nesting_compute, pdf_load, workspace_save, workspace_load.", "labels": ["performance", "infrastructure"], "order": 1, "priority": "high"}
{"id": "REPLAN-006", "status": "closed", "title": "Add unit tests for models module", "created": "2026-01-27", "description": "Create comprehensive unit tests for all data models in replan.desktop.models. Target 90% branch coverage. DONE: 224 tests (up from 175) covering attributes (29 tests including edge cases for negative/zero dimensions, invalid types, size_string variations), categories (comprehensive coverage), elements (comprehensive coverage including all 9 label positions, RLE encoding/decoding verification, edge cases for bounds/centroid/area with single pixels, holes, scattered pixels), objects (comprehensive coverage including edge cases for grouped elements, multiple instances, attribute migration), and page models (comprehensive coverage including edge cases for multiple objects, element counting, pixels_per_inch calculations).", "labels": ["testing"], "order": 2, "priority": "high"}
{"id": "REPLAN-007", "status": "closed", "title": "Add unit tests for core module", "created": "2026-01-27", "depends_on": ["REPLAN-006"], "description": "Create unit tests for segmentation, rendering, and drawing logic. Target 90% branch coverage. COMPLETED: Achieved 93.03% coverage (exceeds 90% target). Added comprehensive tests - segmentation.py: 95% coverage, drawing.py: 96% coverage (added tests for snap branches, empty mask, invalid points, finish methods), rendering.py: 89% coverage (added tests for text mask growth, label drawing branches, pixel selection, empty contours), nesting.py: 78% coverage (added tests for nest_by_material, empty stock parts, boundary clipping, render branches). Models module: 224 tests (100% coverage). Total: 434 tests passing. Coverage target achieved!", "labels": ["testing"], "order": 3, "priority": "high"}
{"id": "REPLAN-016", "status": "closed", "title": "Implement DXF vector export", "created": "2026-01-27", "description": "Add DXF export using contour extraction from SegmentationEngine.get_contours(). Extract polygon paths from raster masks and export as DXF polylines for CAD/laser cutting workflows. DONE: Created vector_export.py with ContourExtractor, DXFExporter classes.", "labels": ["feature", "export", "vectorization"], "order": 4, "priority": "high"}
{"id": "REPLAN-017", "status": "closed", "title": "Implement SVG vector export", "created": "2026-01-27", "depends_on": ["REPLAN-016"], "description": "Add SVG export using contour extraction. Export segment boundaries as SVG paths for scalable vector editing and web display. DONE: Created SVGExporter with category grouping, colors, and path data generation.", "labels": ["feature", "export", "vectorization"], "order": 5, "priority": "high"}
{"id": "REPLAN-018", "status": "closed", "title": "Implement 1D linear material nesting for sticks/strips", "created": "2026-01-27", "description": "Add 1D bin packing algorithm for linear materials (balsa strips, spruce sticks, longerons, spars). DONE: Added LinearNestingEngine with FFD algorithm, LinearPart, NestedStock, NestedLinearPart dataclasses.", "labels": ["feature", "nesting", "materials"], "order": 6, "priority": "high"}
{"id": "REPLAN-019", "status": "closed", "title": "Add structured cut list/inventory export from nesting", "created": "2026-01-27", "depends_on": ["REPLAN-018"], "description": "Generate shopping list from nesting results: how many sheets of each size/material, how many sticks of each dimension. DONE: Added InventoryExporter with export_inventory(), export_shopping_list(), export_cut_list_text() methods.", "labels": ["feature", "export", "nesting"], "order": 7, "priority": "high"}
{"id": "REPLAN-020", "status": "closed", "title": "Implement 1:1 scale printing with DPI handling", "created": "2026-01-27", "description": "Add print functionality that uses stored DPI and physical dimensions (pdf_width_inches, pdf_height_inches in PageTab) to output parts at actual size. DONE: Created printing.py with ScaledPrinter, PrintSettings, tile export, alignment marks, and scale bar.", "labels": ["feature", "printing"], "order": 8, "priority": "high"}
{"id": "REPLAN-008", "status": "closed", "title": "Add integration tests", "created": "2026-01-27", "depends_on": ["REPLAN-006", "REPLAN-007"], "description": "Create end-to-end workflow tests: load PDF -> segment -> save workspace. Target 90% branch coverage. COMPLETED: Created comprehensive integration tests in tests/integration/test_workflow.py covering: PDF loading workflow, segmentation workflow (flood fill, polygon, line masks), workspace save/load workflow, complete end-to-end workflow (create page -> segment -> save -> load), multi-page workflows. Added performance tests in test_performance.py to verify PDF load (< 2s) and flood fill (< 1s) targets. Total: 12 integration tests passing.", "labels": ["testing"], "order": 9, "priority": "high"}
{"id": "REPLAN-002", "status": "closed", "title": "Optimize PDF loading to < 2 seconds", "created": "2026-01-27", "depends_on": ["REPLAN-001"], "description": "Profile and optimize PDF loading, page rendering, and initial display. COMPLETED: Optimizations implemented - use alpha=False to get RGB directly (avoids RGBA->BGR conversion), direct memory access via np.frombuffer, single RGB->BGR conversion, automatic resizing for large images. Performance profiling in place via @timed('pdf_load') decorator with 2000ms target. Code verified in pdf_reader.py:load_with_dimensions(). Integration tests added to verify performance targets.", "labels": ["performance", "pdf"], "order": 10, "priority": "high"}
{"id": "REPLAN-046", "status": "closed", "title": "Preserve object physical size when moving between pages or creating pages from planforms", "created": "2026-01-29", "description": "When objects are moved between pages or when pages are created from planforms, the physical size attributes (width, height, depth in ObjectAttributes) are not being preserved. Currently, masks and points are scaled based on pixel dimensions only, which causes objects to change physical size when moved between pages with different DPI or physical dimensions. Implementation needed: 1) When moving objects between pages (_move_object_to_page, _move_instance_to_page), calculate scale factor based on pixels_per_inch ratio (target_page.pixels_per_inch / source_page.pixels_per_inch) instead of just pixel dimensions, 2) Preserve ObjectAttributes.width, height, depth values (they represent physical dimensions in inches/cm), 3) Scale masks and points using the pixels_per_inch ratio to maintain physical size, 4) When creating view pages from planforms (_create_view_tab_from_planform), preserve physical size attributes of copied objects and scale masks/points based on DPI ratio if the cropped page has different DPI, 5) Ensure size_string display correctly reflects preserved dimensions. This is critical for maintaining accurate part dimensions across multi-page plans with varying scales.", "labels": ["bug", "editing", "pages", "planform", "size"], "order": 11, "priority": "high"}
{"id": "REPLAN-003", "status": "closed", "title": "Optimize flood fill to < 1 second", "created": "2026-01-27", "depends_on": ["REPLAN-001"], "description": "Profile and optimize flood fill operations for typical image sizes. COMPLETED: Optimizations implemented - check if image is already grayscale before conversion (avoids unnecessary cv2.cvtColor), efficient mask extraction using direct indexing (result[1:-1, 1:-1]), binary conversion using multiplication (faster than np.where), use FLOODFILL_MASK_ONLY flag. Performance profiling in place via @timed('flood_fill') decorator with 1000ms target. Code verified in segmentation.py:flood_fill(). Integration tests added to verify performance targets.", "labels": ["performance", "segmentation"], "order": 11, "priority": "high"}
{"id": "REPLAN-045", "status": "closed", "title": "Fix delete pixels option - pixel deletion not working", "created": "2026-01-29", "description": "The delete pixels option in the delete dialog is not working correctly. When users select \"Delete pixels (remove pixels from image, set to white)\" and confirm deletion, the pixels should be removed from the original_image by setting them to white, but this is not happening or not being reflected in the display. Investigation needed: 1) Verify _delete_pixels_from_objects() is correctly modifying page.original_image, 2) Check if working image cache needs invalidation after pixel deletion, 3) Ensure canvas is redrawn after pixel deletion, 4) Verify mask combination logic is correct, 5) Check if cache invalidation at line 7266 is sufficient or if page-specific invalidation is needed, 6) Ensure original_image changes persist in workspace saves. This is a critical bug affecting core editing functionality.", "labels": ["bug", "editing", "pixels"], "order": 12, "priority": "high"}
{"id": "REPLAN-004", "status": "closed", "title": "Implement auto text region detection", "created": "2026-01-27", "description": "COMPLETED: Added CV-based automatic detection of text regions in drawings. Implemented _detect_text_regions() using pytesseract OCR with word-level detection, _auto_detect_text_for_page() for background detection, integrated automatic detection in _add_page() when pages are loaded (not from workspace), added UI controls in settings dialog (Preferences > Behavior). Users can enable/disable automatic text detection. Detection runs in background (100ms delay) to avoid blocking UI. Detected regions are added to mark_text category as objects.", "labels": ["feature", "auto-detection"], "order": 12, "priority": "high"}
{"id": "REPLAN-047", "status": "closed", "title": "Add Ctrl+/- and Ctrl+mouse wheel zoom shortcuts and fix Tools panel mouse wheel focus", "created": "2026-01-29", "description": "Users need keyboard shortcuts (Ctrl+/-) and mouse wheel zoom (Ctrl+mouse wheel) for zooming in/out. Currently only menu items exist. Also, the Tools panel sometimes doesn't respond to mouse wheel scrolling due to focus issues. Implementation needed: 1) Ensure Ctrl+/- keyboard shortcuts work reliably (currently bound but may need focus handling), 2) Add Ctrl+mouse wheel support for zooming when mouse is over canvas (currently mouse wheel only scrolls), 3) Fix Tools panel mouse wheel scrolling - the bind_all approach interferes with focus, should use widget-specific binding instead of bind_all, 4) Ensure mouse wheel scrolling in Tools panel works even when panel doesn't have focus, 5) Make sure canvas zoom with Ctrl+mouse wheel doesn't interfere with normal scrolling when Ctrl is not pressed. This improves workflow efficiency and fixes a usability issue.", "labels": ["feature", "ui", "zoom", "bug"], "order": 13, "priority": "high"}
{"id": "REPLAN-005", "status": "closed", "title": "Implement auto hatch region detection", "created": "2026-01-27", "description": "COMPLETED: Added CV-based automatic detection of hatching/cross-hatch pattern regions. Implemented _detect_hatching_regions() using Canny edge detection and Hough transform to find diagonal line patterns typical of hatching (~45┬░ or ~135┬░), _auto_detect_hatch_for_page() for background detection, integrated automatic detection in _add_page() when pages are loaded (not from workspace), added UI controls in settings dialog (Preferences > Behavior). Users can enable/disable automatic hatch detection. Detection runs in background (200ms delay) to avoid blocking UI. Uses morphological operations to group nearby lines into regions.", "labels": ["feature", "auto-detection"], "order": 13, "priority": "high"}
{"id": "REPLAN-044", "status": "closed", "title": "Add ability to delete pages/views", "created": "2026-01-29", "description": "Users need to be able to delete pages/views from the application. Currently pages can only be added but not removed. Implementation should: 1) Add delete option to page tab context menu (right-click), 2) Add keyboard shortcut (e.g., Ctrl+Delete or Delete key when tab is focused), 3) Show confirmation dialog before deletion (especially if page has objects), 4) Remove page from self.pages dict, 5) Close/remove the tab from notebook, 6) Clean up all objects associated with that page (remove from all_objects list, update planform_objects if needed), 7) Handle case where current page is deleted (switch to another page or show empty state), 8) Invalidate caches related to deleted page, 9) Update workspace modified flag. This is essential for managing multi-page workspaces and removing unwanted pages.", "labels": ["feature", "ui", "pages"], "order": 14, "priority": "high"}
{"id": "REPLAN-038", "status": "closed", "title": "Optimize OCR to reduce false positive text detections", "created": "2026-01-27", "description": "COMPLETED: Optimized OCR text detection to significantly reduce false positives. Implemented multiple filtering criteria: increased confidence threshold (30ΓåÆ50), changed PSM mode (3ΓåÆ6 for uniform text blocks), stricter size limits (5% max area, 8x8 min), aspect ratio filtering (reject very wide/tall boxes), text content validation (require alphanumeric content, filter single symbols), and pixel density checks (10-70% dark pixels). These filters ensure only actual text regions are detected, reducing the number of text_xxx false positive objects.", "labels": ["bug", "ocr", "optimization"], "order": 15, "priority": "high"}
{"id": "REPLAN-039", "status": "closed", "title": "Fix text grouping algorithm to properly group multi-line textboxes", "created": "2026-01-27", "description": "COMPLETED: Fixed text grouping algorithm that was incorrectly splitting multi-line textboxes. The old algorithm was creating vertical sections mixing words from different lines. New two-stage approach: Stage 1 groups regions into lines (horizontally aligned), Stage 2 groups lines into textboxes (vertically aligned with similar left/right edges). This ensures a 3-line textbox is grouped as a single textbox rather than being split into separate vertical sections.", "labels": ["bug", "ocr", "text-grouping"], "order": 16, "priority": "high"}
{"id": "REPLAN-040", "status": "closed", "title": "Fix object viewer panel width restoration on high DPI displays", "created": "2026-01-27", "description": "COMPLETED: Fixed object viewer panel width restoration on high DPI displays (3840x2160). Issue was that absolute pixel widths don't scale correctly with DPI scaling. Solution: Store panel width as both absolute pixels and as a ratio of window width. During restoration, prefer ratio-based calculation for high DPI compatibility. This ensures panel width scales correctly regardless of display DPI scaling. Added better debugging output and more lenient thresholds for high DPI displays.", "labels": ["bug", "ui", "workspace", "high-dpi"], "order": 17, "priority": "high"}
{"id": "REPLAN-041", "status": "closed", "title": "Fix OCR text grouping - restore ability to group textboxed text", "created": "2026-01-27", "description": "COMPLETED: Fixed OCR text grouping that had lost ability to group multi-line textboxes. Issues: max_group_size=10 was too small for paragraphs, edge alignment too strict, vertical gap too restrictive. Solution: Increased max_group_size to 50, made edge tolerance more lenient (80px or 2x line height), increased vertical gap tolerance (80px or 4x line height), relaxed horizontal overlap requirement (10% instead of 15-20%), added center-y-based line detection, increased horizontal gap tolerance (100px or 4x avg height). Grouping now properly groups multi-line paragraphs into single textbox objects.", "labels": ["bug", "ocr", "text-grouping"], "order": 18, "priority": "high"}
{"id": "REPLAN-042", "status": "closed", "title": "Improve OCR accuracy using two-pass approach and uniform text characteristics", "created": "2026-01-27", "description": "COMPLETED: Implemented two-pass OCR approach: Pass 1 detects text-dense regions using edge detection (Canny) and sliding windows to identify areas with consistent text-like patterns. Pass 2 runs focused OCR on those regions for better accuracy. Added filter_structural_false_positives() to filter based on uniform text characteristics: size consistency (reject outliers >2 std dev), character spacing consistency, structural pattern detection (oo=holes, AY/IN=fuselage parts), and text size uniformity. This improves grouping accuracy by focusing OCR on actual text regions rather than structural elements that look like text.", "labels": ["feature", "ocr", "optimization"], "order": 36, "priority": "high"}
{"id": "REPLAN-043", "status": "closed", "title": "Fix object viewer panel width save/restore - use sash position", "created": "2026-01-27", "description": "COMPLETED: Fixed object viewer panel width not being saved correctly. Issue was that winfo_width() was unreliable when saving. Solution: Updated _get_view_state() to get panel width from sash position directly (paned_width - sash_position) instead of using winfo_width(). Also updated sash movement handler in responsive_layout.py to use sash position for tracking width changes. This ensures accurate width is saved and restored correctly, especially when panel takes up half the screen.", "labels": ["bug", "ui", "workspace"], "order": 37, "priority": "high"}
{"id": "REPLAN-049", "status": "closed", "title": "Fix delete pixels - mark_line objects not repainting white after deletion", "created": "2026-01-29", "description": "When deleting pixels from mark_line objects (and possibly other categories), the pixels are not being repainted white in the original_image. The delete pixels operation should set deleted pixels to white (255, 255, 255) in page.original_image, but this is not happening for mark_line objects. Investigation needed: 1) Verify _delete_pixels_from_objects() handles mark_line category correctly, 2) Check if mark_line mask combination logic is correct, 3) Ensure original_image is updated before cache invalidation, 4) Verify the mask extraction and white pixel setting logic works for line-based selections.", "labels": ["bug", "editing", "pixels"], "order": 49, "priority": "high"}
{"id": "REPLAN-050", "status": "closed", "title": "Fix Move to Page scaling - preserve 1:1 pixel-to-inch ratio across pages", "created": "2026-01-29", "description": "When moving objects to a new page (especially via Create View tab from Planform), the created page should maintain the same 1:1 size ratio to the original page, and object pixel sizes should be preserved across pages. Currently, objects are being scaled incorrectly when moved between pages, resulting in different object scales. Implementation needed: 1) When creating view pages from planforms, ensure the new page has the same pixels_per_inch ratio as the source page, 2) Preserve pixel dimensions of objects when moving between pages (don't scale unless pages have different DPI), 3) Maintain pixel-to-inch ratio from PDF to final print, 4) Fix _move_object_to_page() and _move_instance_to_page() to preserve pixel sizes correctly, 5) Ensure _create_view_tab_from_planform() creates pages with matching DPI/physical dimensions.", "labels": ["bug", "editing", "pages", "planform", "scaling"], "order": 50, "priority": "high", "depends_on": ["REPLAN-046"]}
{"id": "REPLAN-051", "status": "closed", "title": "Fix pixel selection clearing for Rect and Polyline modes", "created": "2026-01-29", "description": "Pixel selection and clearing doesn't work correctly for Rect and Polyline selection modes (and possibly other modes). Users should be able to select pixels using these modes and then clear/delete them, but this functionality is broken. Investigation needed: 1) Verify pixel selection works for rect and polyline modes, 2) Check if _clear_selected_pixels() handles these selection types correctly, 3) Ensure mask generation from rect/polyline selections is correct, 4) Verify the pixel deletion logic works for all selection modes, 5) Test freeform and other modes as well.", "labels": ["bug", "editing", "pixels", "selection"], "order": 51, "priority": "high"}
{"id": "REPLAN-052", "status": "closed", "title": "Fix printing DPI and scale for each page, add printer spooler support", "created": "2026-01-29", "description": "Printing needs to correctly handle DPI and scale for each page individually, and should support printing through the printer spooler with features like tile printing, enlargement, and fitting to different paper sizes. Currently printing may not be using the correct DPI per page. Implementation needed: 1) Ensure each page's DPI (from pdf_dpi or pixels_per_inch) is correctly used when printing that page, 2) Add printer spooler integration (use system print dialog), 3) Support tile printing through printer (split large pages across multiple sheets), 4) Add enlargement/reduction options in print dialog, 5) Support fitting to different paper sizes (A4, Letter, etc.), 6) Ensure scale bar and alignment marks work correctly with printer DPI.", "labels": ["feature", "printing", "dpi"], "order": 52, "priority": "high", "depends_on": ["REPLAN-020"]}
{"id": "REPLAN-055", "status": "closed", "title": "Fix object viewer panel size not preserved on workspace save/load", "created": "2026-01-29", "description": "The object viewer panel size is still not being correctly preserved when workspace is saved and reloaded. Despite previous fixes (REPLAN-029, REPLAN-040, REPLAN-043), the panel width is not restoring correctly. The new approach of saving sidebar and center widths should work, but may need further debugging. Investigation needed: 1) Verify sidebar_width and center_width are being saved correctly in _get_view_state(), 2) Check if restoration logic in _restore_view_state() is working properly, 3) Ensure sash positions are set correctly during restoration, 4) Test on different screen resolutions and DPI settings, 5) Add more debug logging to trace the save/restore process.", "labels": ["bug", "ui", "workspace"], "order": 55, "priority": "high"}
{"id": "REPLAN-058", "status": "closed", "title": "Implement undo functionality for all operations", "created": "2026-01-29", "description": "Undo functionality is missing or doesn't work for many operations including delete. Users need to be able to undo their actions. Implementation needed: 1) Create undo/redo system with command pattern, 2) Track all user actions (create, delete, move, transform, category change, etc.), 3) Implement undo stack with configurable depth (e.g., 50 actions), 4) Add Ctrl+Z for undo, Ctrl+Y or Ctrl+Shift+Z for redo, 5) Update menu items to show available undo/redo actions, 6) Ensure workspace modifications are tracked correctly with undo system, 7) Test undo for all major operations (delete, move, create, category change, pixel deletion, etc.).", "labels": ["feature", "editing", "undo"], "order": 58, "priority": "high"}

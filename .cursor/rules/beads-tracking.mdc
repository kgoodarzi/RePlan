---
description: Require all identified issues and gaps to be tracked in Beads
alwaysApply: true
---

# Beads Issue Tracking

All identified issues, bugs, gaps, and feature requests MUST be added to Beads.

## When to Add Issues

- When reviewing code and finding gaps or missing features
- When identifying bugs during testing or code review
- When planning work and discovering new requirements
- When the user reports a problem or requests a feature

## How to Add Issues

Add issues to `.beads/issues.jsonl` with this format:

```json
{"id": "REPLAN-XXX", "title": "Brief title", "description": "Detailed description", "priority": "high|medium|low", "status": "open", "labels": ["label1", "label2"], "created": "YYYY-MM-DD"}
```

## Required Fields

- `id`: Sequential ID (REPLAN-001, REPLAN-002, etc.)
- `title`: Brief, descriptive title
- `description`: What needs to be done and why
- `priority`: "high" (blockers), "medium" (important), "low" (nice-to-have)
- `status`: "open", "in_progress", "closed"
- `labels`: Relevant tags (feature, bug, performance, testing, etc.)
- `created`: Date in YYYY-MM-DD format

## Priority Guidelines

- **high**: Workflow blockers, critical bugs, security issues
- **medium**: Important features, significant improvements
- **low**: Nice-to-have features, minor enhancements

## File Organization

**IMPORTANT**: When editing `.beads/issues.jsonl`, ALWAYS maintain this organization:

1. **Active issues first**: All issues with status "open" or "in_progress" must appear at the top of the file
2. **Closed issues last**: All issues with status "closed" must be moved to the end of the file
3. **Priority ordering**: Within each group (active/closed), issues must be ordered by priority: high → medium → low
4. **Secondary sort**: Within the same priority, sort by the `order` field (if present) or creation date

This ensures that active work items are easily visible, prioritized correctly, and closed items don't clutter the top of the list.

### When Editing the File

- After ANY edit to `.beads/issues.jsonl`, ALWAYS reorganize the file:
  1. Separate active issues (open/in_progress) from closed issues
  2. Sort active issues by priority (high → medium → low), then by `order` field
  3. Sort closed issues by priority (high → medium → low), then by `order` field
  4. Write active issues first, then closed issues

### Priority Ordering

Priority values are ordered as:
- `high` = 0 (highest priority)
- `medium` = 1
- `low` = 2 (lowest priority)

Use this Python code to reorganize:
```python
import json
priority_order = {'high': 0, 'medium': 1, 'low': 2}
lines = [json.loads(l) for l in open('.beads/issues.jsonl', 'r', encoding='utf-8')]
open_issues = [l for l in lines if l['status'] in ['open', 'in_progress']]
closed_issues = [l for l in lines if l['status'] == 'closed']
open_issues.sort(key=lambda x: (priority_order.get(x.get('priority', 'low'), 2), x.get('order', 999)))
closed_issues.sort(key=lambda x: (priority_order.get(x.get('priority', 'low'), 2), x.get('order', 999)))
f = open('.beads/issues.jsonl', 'w', encoding='utf-8')
[f.write(json.dumps(issue, ensure_ascii=False) + '\n') for issue in open_issues + closed_issues]
f.close()
```
